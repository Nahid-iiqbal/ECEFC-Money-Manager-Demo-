{% extends "base.html" %}

{% block title %}Dashboard - FeinBuddy{% endblock %}

{% block extra_css %}
<link href="{{ url_for('static', filename='css/dashboard.css') }}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h2 class="flicker">ğŸ“Š Control Room</h2>
    <p class="dashboard-subtitle">Track your expenses, groups, and tuition at a glance</p>
</div>

<!-- Profile Alert if not created -->
{% if not current_user.profile %}
<div class="profile-alert">
    <div class="alert alert-info">
        <strong>ğŸ‘¤ Complete Your Profile!</strong>
        <p>Set up your profile to unlock all features.</p>
        <a href="{{ url_for('profile.create_profile') }}" class="btn btn-sm">Create Profile</a>
    </div>
</div>
{% endif %}

<div class="summary-cards">
    <div class="summary-card card-purple">
        <div class="card-icon">ğŸ’°</div>
        <div class="card-content">
            <h3>Personal Expenses</h3>
            <p class="card-subtitle">This Month</p>
            <p class="card-amount">à§³{{ "%.2f"|format(personal_this_month) }}</p>
        </div>
    </div>
    
    <div class="summary-card card-blue">
        <div class="card-icon">ğŸ‘¥</div>
        <div class="card-content">
            <h3>Group Balance</h3>
            <p class="card-subtitle">Outstanding</p>
            <p class="card-amount {{ balance_status }}">
                {% if group_balance >= 0 %}
                    +à§³{{ "%.2f"|format(group_balance) }}
                {% else %}
                    -à§³{{ "%.2f"|format(group_balance|abs) }}
                {% endif %}
            </p>
        </div>
    </div>
    
    <div class="summary-card card-orange">
        <div class="card-icon">ğŸ“</div>
        <div class="card-content">
            <h3>Pending Tuition</h3>
            <p class="card-subtitle">Due Amount</p>
            <p class="card-amount">à§³{{ "%.2f"|format(pending_tuition) }}</p>
        </div>
    </div>
    
    <div class="summary-card card-green">
        <div class="card-icon">ğŸ“…</div>
        <div class="card-content">
            <h3>Total Expenses</h3>
            <p class="card-subtitle">All Time</p>
            <p class="card-amount">à§³{{ "%.2f"|format(total_all_time) }}</p>
        </div>
    </div>
</div>

<div class="quick-actions-section">
    <h3>âš¡ Quick Actions</h3>
    <div class="quick-actions">
        <button class="action-btn btn-purple" onclick="window.location.href='{{ url_for('expense.personal') }}'">
            <span class="btn-icon">â•</span>
            Add Personal Expense
        </button>
        <button class="action-btn btn-blue" disabled style="opacity: 0.5; cursor: not-allowed;">
            <span class="btn-icon">â•</span>
            Add Group Expense
        </button>
        <button class="action-btn btn-orange" disabled style="opacity: 0.5; cursor: not-allowed;">
            <span class="btn-icon">â•</span>
            Add Tuition Payment
        </button>
    </div>
</div>

<div class="recent-activity-section">
    <h3>ğŸ“ Recent Activity</h3>
    
    {% if recent_activities %}
        <div class="activity-list">
            {% for activity in recent_activities %}
                <div class="activity-item">
                    <div class="activity-icon {{ activity.type|lower }}">
                        {% if activity.type == 'Personal' %}ğŸ’°
                        {% elif activity.type == 'Group' %}ğŸ‘¥
                        {% else %}ğŸ“{% endif %}
                    </div>
                    <div class="activity-details">
                        <div class="activity-header">
                            <span class="activity-type badge-{{ activity.type|lower }}">{{ activity.type }}</span>
                            <span class="activity-date">{{ activity.date }}</span>
                        </div>
                        <p class="activity-description">{{ activity.description }}</p>
                    </div>
                    <div class="activity-amount">à§³{{ activity.amount }}</div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state">
            <p class="empty-icon">ğŸ“­</p>
            <p class="empty-text">No recent activity yet</p>
            <p class="empty-subtext">Start by adding your first expense!</p>
        </div>
    {% endif %}
</div>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}
